"0","sites_unique_year <- unique(acp38_year$site)"
"0","all_correlations_year <- data.frame( site = character(),"
"0","                                dataset=character(),"
"0","                                Correlation = numeric(),"
"0","                                RMSE = numeric(),"
"0","                                stringsAsFactors = FALSE)"
"0",""
"0",""
"0","for (j in seq_along(datasets_yearly)){"
"0","  print(datasets_yearly[[j]]$dataset_name)"
"0","  for (i in seq_along(sites_unique_year))  {"
"0","    temporal_range <- datasets_yearly[[j]]$temporal"
"0","    name <- datasets_yearly[[j]]$dataset_name"
"0","    col_name <- datasets_yearly[[j]]$column_name"
"0","    site_data <- acp38_year[acp38_year$site == sites_unique_year[i] & acp38_year$temporal == temporal_range & acp38_year$dataset_name==name,]"
"0","    cor_test_result <- cor.test(as.numeric(site_data$annual_precip), as.numeric(unlist(site_data[, col_name])), na.rm = TRUE)$estimate"
"0","    rmse <- sqrt(mean((as.numeric(unlist(site_data[, col_name])) - site_data$annual_precip)^2, na.rm = TRUE))"
"0","    new_row <- data.frame(site = sites_unique_year[i], dataset = name, Correlation = cor_test_result, RMSE = rmse)"
"0","    all_correlations_year <- rbind(all_correlations_year, new_row)"
"0","  }"
"0","}"
"1","[1]"
"1"," ""CHELSA 1.2"""
"1","
"
"1","[1]"
"1"," ""CHELSA 2.1"""
"1","
"
"1","[1]"
"1"," ""CHELSA EarthEnv"""
"1","
"
"1","[1]"
"1"," ""CHIRPS 2.0"""
"1","
"
"1","[1]"
"1"," ""CHELSA-W5E5v1.0"""
"1","
"
"1","[1]"
"1"," ""TerraClimate"""
"1","
"
"0","summary_table <- all_correlations_year %>%"
"0","  group_by(dataset) %>%"
"0","  summarise(Correlation = mean(Correlation, na.rm = TRUE),"
"0","            RMSE = mean(RMSE, na.rm = TRUE))"
"0",""
"0","interannual_table <- summary_table %>%"
"0","  mutate(Correlation = round(Correlation, 2), RMSE = round(RMSE, 0)) %>%"
"0","  rename(""Mean Correlation"" = Correlation, ""Mean RMSE"" = RMSE) %>%"
"0","  rownames_to_column(var = ""Dataset"") %>%"
"0","  kbl(caption = ""Summary of Correlation and RMSE by Dataset"") "
"0","interannual_table%>% kable_classic(full_width = FALSE)%>%save_kable(""../plots/interannual_table.png"",density=900)"
"0","write.csv(summary_table, file= ""../tables/interannual_variation.csv"")"
"0","write.csv(acp38_year, file = ""../tables/acp38_year.csv"")"
"0","interannual_table"
