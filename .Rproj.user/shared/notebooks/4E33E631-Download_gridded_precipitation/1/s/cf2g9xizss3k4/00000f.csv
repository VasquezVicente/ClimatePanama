"0","#| output: false"
"0","files<- list.files(""../data_reanalysis/CHELSA 2.1/monthly"",full.names = TRUE)"
"0","month<- numeric(length(files))"
"0","year<- numeric(length(files))"
"0","for (i in 1:length(files)) {"
"0","  file_parts <- unlist(strsplit(basename(files[i]), ""_""))"
"0","  month[i] <- as.numeric(file_parts[3])"
"0","  year[i] <- as.numeric(file_parts[4])"
"0","}"
"0","chelsa21<-data.frame(files,month,year)"
"0","if (file.exists(""../data_reanalysis/CHELSA 2.1/yearly"")==FALSE){"
"0","dir.create(""../data_reanalysis/CHELSA 2.1/yearly"", showWarnings = FALSE)"
"0","for (y in unique(chelsa21$year)){"
"0","  print(paste0(""Processing "", y))"
"0","  ras <- raster::stack(chelsa21[chelsa21$year == y, ]$files)"
"0","  print(paste0(""Stacked "", y))"
"0","  ras <- raster::calc(ras, sum)"
"0","  print(paste0(""Calculated "", y))"
"0","  output_file <- paste0(""../data_reanalysis/CHELSA 2.1/yearly/CHELSA_2.1_"", y, "".tif"")"
"0","  raster::writeRaster(ras, filename = output_file, format = ""GTiff"", overwrite = TRUE)"
"0","}"
"0","}else {"
"0","   print(""yearly timeseries already processed"")"
"0","}"
"1","[1]"
"1"," ""yearly timeseries already processed"""
"1","
"
