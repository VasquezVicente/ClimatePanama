"0","#| output: false"
"0","monthly_files<- list.files(""../data_reanalysis/CHELSA-W5E5v1.0/monthly"", pattern="".tif"", full.names = TRUE)"
"0","month <- numeric(length(monthly_files))"
"0","year <- numeric(length(monthly_files))"
"0","for (i in 1:length(monthly_files)) {"
"0","    file_parts <- unlist(strsplit(basename(monthly_files[i]), ""_""))"
"0","    month[i] <- as.numeric(substring(file_parts[3], 1, 2))"
"0","    year[i] <- as.numeric(file_parts[2])"
"0","  }"
"0","monthly_files <- data.frame(monthly_files, month, year)"
"0","if (file.exists(""../data_reanalysis/CHELSA-W5E5v1.0/climatology"")==FALSE){"
"0","  dir.create(""../data_reanalysis/CHELSA-W5E5v1.0/climatology"", showWarnings = FALSE)"
"0","  for (m in unique(monthly_files$month)){"
"0","    print(paste0(""Processing "", m))"
"0","    ras <- raster::stack(monthly_files[monthly_files$month == m, ]$monthly_files)"
"0","    print(paste0(""Stacked "", m))"
"0","    ras <- raster::calc(ras, mean)"
"0","    print(paste0(""Calculated "", m))"
"0","    output_file <- paste0(""../data_reanalysis/CHELSA-W5E5v1.0/climatology/CHELSA-W5E5v1.0_"", m, "".tif"")"
"0","    raster::writeRaster(ras, filename = output_file, format = ""GTiff"", overwrite = TRUE)"
"0","  }"
"0","}else{"
"0","  print(""climatology already calculated"")"
"0","}"
"1","[1]"
"1"," ""climatology already calculated"""
"1","
"
