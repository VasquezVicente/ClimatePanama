"0","checkdir<-function(dataset1) {"
"0","  if (dir.exists(paste0(""../data_reanalysis/"",dataset1)) == FALSE) {"
"0","        dir.create(paste0(""../data_reanalysis/"", dataset1), showWarnings = FALSE)"
"0","        print(paste0(""created directory"", ""./data_reanalysis/"",dataset1))"
"0","      }else{print(paste0(""directory"", ""./data_reanalysis/"",dataset1, "" already exists""))}"
"0","}"
"0","download_chelsa<-function(dataset){"
"0","  for (i in 1:nrow(dataset)) {"
"0","  destfile <- paste0(""../data_reanalysis/"", dataset$source[i], ""/"", dataset$filename[i])"
"0","  if (file.exists(destfile) == FALSE) {"
"0","    print(paste0(""downloading "", dataset$filename[i]))"
"0","    download.file(dataset$link[i], destfile = destfile, method = ""curl"")"
"0","    ras <- terra::rast(destfile)"
"0","    ras <- terra::crop(ras, extentMap)"
"0","    writeRaster(ras, filename = destfile, overwrite = TRUE)"
"0","  }else{"
"0","    print(paste0(""file "", dataset$filename[i], "" already exists""))"
"0","    }"
"0","  }"
"0","}"
"0","download_chelsa2<-function(dataset){"
"0","  for (i in 1:nrow(dataset)) {"
"0","  destfile <- paste0(""../data_reanalysis/"", dataset$source[i], ""/"", dataset$filename[i])"
"0","  if (file.exists(destfile) == FALSE) {"
"0","    print(paste0(""downloading "", dataset$filename[i]))"
"0","    download.file(dataset$link[i], destfile = destfile, method = ""curl"")"
"0","    ras <- terra::rast(destfile)"
"0","    ras <- terra::crop(ras, extentMap)"
"0","    ras <- terra::app(ras, fun = function(x) { x * 0.1 })"
"0","    writeRaster(ras, filename = destfile, overwrite = TRUE)"
"0","  }else{"
"0","    print(paste0(""file "", dataset$filename[i], "" already exists""))"
"0","    }"
"0","  }"
"0","}"
"0","download_chp<-function(dataset){"
"0","  for (i in 1:nrow(dataset)) {"
"0","    destfile <- paste0(""../data_reanalysis/"", dataset$source[i], ""/"", dataset$filename[i])"
"0","    destfile2<- gsub("".gz"","""",destfile)"
"0","    if (file.exists(destfile2) == FALSE) {"
"0","      download.file(dataset$link[i], destfile = destfile, method = ""curl"")"
"0","      R.utils::gunzip(destfile, remove = TRUE)"
"0","      destfile=gsub("".gz"","""",destfile)"
"0","      ras <- terra::rast(destfile)"
"0","      ras <- terra::crop(ras, extentMap)"
"0","      writeRaster(ras, filename = destfile, overwrite = TRUE)"
"0","    }else {"
"0","      print(paste0(destfile2, "" already exists""))"
"0","    }"
"0","  }"
"0","}"
"0","download_terra <- function(dataset) {"
"0","  for (i in 1:nrow(dataset)) {"
"0","    destfile <- paste0(""../data_reanalysis/"", dataset$source[i], ""/"", dataset$filename[i])"
"0","    if (!file.exists(paste0(destfile, ""_01.tif""))) {"
"0","      download.file(dataset$link[i], destfile = destfile, method = ""curl"")"
"0","      ras <- terra::rast(destfile)"
"0","      ras <- terra::crop(ras, extentMap)"
"0","      Sys.sleep(1)"
"0","      for (t in 1:nlyr(ras)) {"
"0","        writeRaster(ras[[t]], filename = sprintf(""%s_%02d.tif"", destfile, t), overwrite = TRUE)"
"0","      }"
"0","      unlink(destfile)"
"0","    } else {"
"0","      print(paste0(destfile, "" already exists""))"
"0","    }"
"0","  }"
"0","}"
"0","download_pbcor<-function(dataset){"
"0","  for (i in 1:nrow(dataset)) {"
"0","    destfile <- paste0(""../data_reanalysis/"", dataset$source[i], ""/"", dataset$filename[i])"
"0","    if (file.exists(destfile) == FALSE) {"
"0","      download.file(dataset$link[i], destfile = destfile, method = ""libcurl"")"
"0","      unzip(destfile, exdir = dirname(destfile))"
"0","      data<-list.files(dirname(destfile),pattern = "".nc"")"
"0","      raschelsa<- terra::rast(paste0(dirname(destfile),""/"",data[1]))"
"0","      raschelsa<- terra::crop(raschelsa, extentMap)"
"0","      for (t in 1:nlyr(raschelsa)) {"
"0","        print(""writting"")"
"0","        writeRaster(raschelsa[[t]], filename = paste0(""../data_reanalysis/"",""_"",t, "".tif""), overwrite = TRUE)"
"0","      }"
"0","      raschp<- terra::rast(paste0(dirname(destfile),""/"",data[2]))"
"0","      raschp<- terra::crop(raschp, extentMap)"
"0","      for (t in 1:nlyr(raschp)) {"
"0","        print(""writting"")"
"0","        writeRaster(raschp[[t]], filename = paste0(destfile,""_"",t, "".tif""), overwrite = TRUE)"
"0","      }"
"0","      rasworl<- terra::rast(paste0(dirname(destfile),""/"",data[3]))"
"0","      rasworl<- terra::crop(rasworl, extentMap)"
"0","      for (t in 1:nlyr(rasworl)) {"
"0","        print(""writting"")"
"0","        writeRaster(rasworl[[t]], filename = paste0(destfile,""_"",t, "".tif""), overwrite = TRUE)"
"0","      }"
"0","      unlink(paste0(dirname(destfile),""/"",data[1]))"
"0","      unlink(paste0(dirname(destfile),""/"",data[2]))"
"0","      unlink(paste0(dirname(destfile),""/"",data[3]))"
"0","      unlink(paste0(dirname(destfile),""/"",""readme.txt""))"
"0","      unlink(destfile)"
"0","    }else {"
"0","      print(paste0(destfile, "" already exists""))"
"0","    }"
"0","  }"
"0","}"
